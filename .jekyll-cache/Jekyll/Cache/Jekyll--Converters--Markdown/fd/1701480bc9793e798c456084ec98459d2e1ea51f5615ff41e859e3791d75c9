I"ş<!-- TOC -->

<ul>
  <li><a href="#ä¸€æ•°æ®å¤„ç†å·¥å…·pandaså’Œnumpy">ä¸€.æ•°æ®å¤„ç†å·¥å…·pandaså’Œnumpy</a>
    <ul>
      <li><a href="#11-pandasè¯»å–æ•°æ®">1.1 pandasè¯»å–æ•°æ®</a></li>
      <li><a href="#12-numpyrandom-ç”Ÿæˆæ•°æ®çš„ç”¨æ³•">1.2 numpy.random ç”Ÿæˆæ•°æ®çš„ç”¨æ³•</a></li>
      <li><a href="#13-pandas_profiling">1.3 pandas_profiling</a></li>
      <li><a href="#14-pandaså»æ‰é‡å¤é¡¹-dfdrop_duplicates">1.4 pandaså»æ‰é‡å¤é¡¹ df.drop_duplicates()</a></li>
      <li><a href="#15-pandasä¸­locå’ŒilocåŒºåˆ«">1.5 pandasä¸­locå’ŒilocåŒºåˆ«</a></li>
      <li><a href="#18-è®¡ç®—ç‰¹å¾ä¹‹é—´çš„ç›¸å…³ç³»æ•°">1.8 è®¡ç®—ç‰¹å¾ä¹‹é—´çš„ç›¸å…³ç³»æ•°</a></li>
      <li><a href="#19-dataframeçš„æ‹¼æ¥">1.9 dataframeçš„æ‹¼æ¥</a></li>
      <li><a href="#110-groupbyçš„ä½¿ç”¨">1.10  groupbyçš„ä½¿ç”¨</a></li>
      <li><a href="#111-seriesapply">1.11  Series.apply</a></li>
      <li><a href="#112-serieså¯ä»¥ç›´æ¥ç”¨äº2ä¸ªåˆ—ç›¸åŠ å‡">1.12  Serieså¯ä»¥ç›´æ¥ç”¨äº2ä¸ªåˆ—ç›¸åŠ å‡</a></li>
    </ul>
  </li>
  <li><a href="#äºŒç»˜å›¾æŸ¥çœ‹æ•°æ®åˆ†å¸ƒseabornå’Œmatplotlib">äºŒ.ç»˜å›¾æŸ¥çœ‹æ•°æ®åˆ†å¸ƒâ€”â€”seabornå’Œmatplotlib</a>
    <ul>
      <li><a href="#21-é¢‘æ•°åˆ†å¸ƒç›´æ–¹å›¾">2.1 é¢‘æ•°åˆ†å¸ƒç›´æ–¹å›¾</a></li>
      <li><a href="#22-æ•£ç‚¹å›¾">2.2 æ•£ç‚¹å›¾</a></li>
      <li><a href="#23-ç›´çº¿å›¾">2.3 ç›´çº¿å›¾</a></li>
      <li><a href="#24-åŒå˜é‡åˆ†å¸ƒå›¾">2.4 åŒå˜é‡åˆ†å¸ƒå›¾</a></li>
      <li><a href="#25-å¤šå˜é‡ä¸¤ä¸¤ä¹‹é—´çš„åˆ†å¸ƒå›¾">2.5 å¤šå˜é‡ä¸¤ä¸¤ä¹‹é—´çš„åˆ†å¸ƒå›¾</a></li>
      <li><a href="#26-çƒ­åº¦å›¾">2.6 çƒ­åº¦å›¾</a></li>
    </ul>
  </li>
  <li><a href="#ä¸‰æœºå™¨å­¦ä¹ åŒ…sklearn">ä¸‰.æœºå™¨å­¦ä¹ åŒ…sklearn</a>
    <ul>
      <li><a href="#31-åˆ’åˆ†æ•°æ®é›†">3.1 åˆ’åˆ†æ•°æ®é›†</a></li>
      <li><a href="#32-ç‰¹å¾æ ‡å‡†åŒ–">3.2 ç‰¹å¾æ ‡å‡†åŒ–</a>
        <ul>
          <li><a href="#321-ç¬¬ä¸€ç§">3.2.1 ç¬¬ä¸€ç§</a></li>
          <li><a href="#322-ç¬¬äºŒç§">3.2.2 ç¬¬äºŒç§</a></li>
        </ul>
      </li>
      <li><a href="#33-äº¤å‰éªŒè¯æŸ¥éªŒæ¨¡å‹ç¨³å®šæ€§">3.3 äº¤å‰éªŒè¯â€”â€”æŸ¥éªŒæ¨¡å‹ç¨³å®šæ€§</a></li>
      <li><a href="#34-æ¨¡å‹è¯„ä¼°æ–¹å¼æ··æ·†çŸ©é˜µ">3.4 æ¨¡å‹è¯„ä¼°æ–¹å¼â€”â€”æ··æ·†çŸ©é˜µ</a></li>
      <li><a href="#35-åˆ†ç±»ç»“æœå±•ç¤ºå‡†ç¡®æ€§å¬å›ç‡f1-score">3.5 åˆ†ç±»ç»“æœå±•ç¤ºï¼ˆå‡†ç¡®æ€§ï¼Œå¬å›ç‡ï¼Œf1-scoreï¼‰</a></li>
      <li><a href="#36-æ¨¡å‹çš„ä¿å­˜å’ŒåŠ è½½">3.6 æ¨¡å‹çš„ä¿å­˜å’ŒåŠ è½½</a></li>
      <li><a href="#37-æ•°æ®æ ·æœ¬ä¸å‡è¡¡smoteenn">3.7 æ•°æ®æ ·æœ¬ä¸å‡è¡¡â€”â€”SMOTEENN</a></li>
      <li><a href="#38-è‡ªåŠ¨è¶…å‚è°ƒèŠ‚">3.8 è‡ªåŠ¨è¶…å‚è°ƒèŠ‚</a>
        <ul>
          <li><a href="#381-è‡ªåŠ¨è°ƒå‚gridsearchcv">3.8.1 è‡ªåŠ¨è°ƒå‚â€”â€”GridSearchCV</a></li>
          <li><a href="#382-è‡ªåŠ¨è°ƒå‚ç¥å™¨hyperopt">3.8.2 è‡ªåŠ¨è°ƒå‚ç¥å™¨â€”â€”Hyperopt</a></li>
        </ul>
      </li>
      <li><a href="#39-to_categorical">3.9 to_categorical</a></li>
      <li><a href="#310-ç»˜åˆ¶rocæ›²çº¿">3.10 ç»˜åˆ¶ROCæ›²çº¿</a></li>
    </ul>
  </li>
  <li><a href="#å››åˆ†ç±»æ¨¡å‹">å››.åˆ†ç±»æ¨¡å‹</a>
    <ul>
      <li><a href="#41-éšæœºæ£®æ—">4.1 éšæœºæ£®æ—</a></li>
      <li><a href="#42xgboost">4.2.Xgboost</a></li>
      <li><a href="#43-svm">4.3 SVM</a></li>
    </ul>
  </li>
  <li><a href="#äº”èšç±»æ¨¡å‹">äº”.èšç±»æ¨¡å‹</a>
    <ul>
      <li><a href="#51è½®å»“ç³»æ•°">5.1.è½®å»“ç³»æ•°</a></li>
    </ul>
  </li>
</ul>

<!-- /TOC -->

<h3 id="ä¸€æ•°æ®å¤„ç†å·¥å…·pandaså’Œnumpy">ä¸€.æ•°æ®å¤„ç†å·¥å…·pandaså’Œnumpy</h3>
<h4 id="11-pandasè¯»å–æ•°æ®">1.1 pandasè¯»å–æ•°æ®</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"data.csv"</span><span class="p">,</span><span class="n">index_col</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">encoding</span> <span class="o">=</span> <span class="s">"utf-8"</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_tabel</span><span class="p">(</span><span class="s">"data.txt"</span><span class="p">,</span><span class="n">sep</span> <span class="o">=</span> <span class="s">","</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="12-numpyrandom-ç”Ÿæˆæ•°æ®çš„ç”¨æ³•">1.2 numpy.random ç”Ÿæˆæ•°æ®çš„ç”¨æ³•</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">numpy</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>  <span class="o">==&gt;</span><span class="n">ç”Ÿæˆ4</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span><span class="n">çš„çŸ©é˜µ</span><span class="err">ï¼Œ</span><span class="n">å…¶ä¸­å…ƒç´ åœ¨</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="err">ï¼Œ</span><span class="nb">float</span>
<span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>  <span class="o">==&gt;</span><span class="n">ç”Ÿæˆ4</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span><span class="n">çš„çŸ©é˜µ</span><span class="err">ï¼Œ</span><span class="n">å…ƒç´ æ˜¯æ ‡å‡†æ­£æ€åˆ†å¸ƒ</span><span class="err">ï¼ˆ</span><span class="n">ä»¥0ä¸ºå‡å€¼</span><span class="err">ã€</span><span class="n">ä»¥1ä¸ºæ ‡å‡†å·®çš„æ­£æ€åˆ†å¸ƒ</span><span class="err">ï¼Œ</span><span class="n">è®°ä¸ºN</span><span class="err">ï¼ˆ</span><span class="mi">0</span><span class="err">ï¼Œ</span><span class="mi">1</span><span class="err">ï¼‰ï¼‰ï¼Œ</span><span class="nb">float</span>
<span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>  <span class="o">==&gt;</span><span class="n">ç”Ÿæˆä¸€ä¸ª2</span><span class="o">*</span><span class="mi">2</span><span class="n">çš„çŸ©é˜µ</span><span class="err">ï¼Œ</span><span class="n">å…ƒç´ å€¼åœ¨</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="n">éšæœºæ•´æ•°</span><span class="err">ï¼Œ</span><span class="nb">int</span>
<span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">random_sample</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>  <span class="o">==&gt;</span><span class="n">ç”Ÿæˆä¸€ä¸ª2</span><span class="o">*</span><span class="mi">2</span><span class="n">çš„çŸ©é˜µ</span><span class="err">ï¼Œ</span><span class="n">å…ƒç´ æ˜¯</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="nb">float</span>
<span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1676</span><span class="p">)</span> <span class="o">==&gt;</span><span class="n">è®¾ç½®ç§å­æ•°</span><span class="err">ï¼Œ</span><span class="n">æ¯æ¬¡ç”Ÿæˆçš„éšæœºæ•°ç›¸åŒ</span>
</code></pre></div></div>

<h4 id="13-pandas_profiling">1.3 pandas_profiling</h4>
<p>ç”¨äºç®€å•å¿«é€ŸæŸ¥çœ‹æ•°æ®åˆ†å¸ƒå’Œå¾—åˆ°æ•°æ®æŠ¥å‘Šã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas_profiling</span>
<span class="n">pfr</span> <span class="o">=</span> <span class="n">pandas_profiling</span><span class="p">.</span><span class="n">ProfileReport</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">pfr</span><span class="p">.</span><span class="n">to_file</span><span class="p">(</span><span class="s">"./example.html"</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="14-pandaså»æ‰é‡å¤é¡¹-dfdrop_duplicates">1.4 pandaså»æ‰é‡å¤é¡¹ df.drop_duplicates()</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">.</span><span class="n">duplicated</span><span class="p">()].</span><span class="n">shape</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
<span class="n">df</span><span class="p">.</span><span class="n">shape</span>
</code></pre></div></div>

<h4 id="15-pandasä¸­locå’ŒilocåŒºåˆ«">1.5 pandasä¸­locå’ŒilocåŒºåˆ«</h4>

<ul>
  <li>
    <p><strong>loc</strong>åˆ©ç”¨indexçš„åç§°ï¼ˆ<strong>è¿™é‡Œå¯ä»¥æ˜¯indexå’Œè¡Œå·ä¸ä¸€è‡´</strong>ï¼‰ï¼Œæ¥è·å–æƒ³è¦çš„è¡Œï¼ˆæˆ–åˆ—ï¼‰ã€‚ï¼ˆåç§°å¯¼å‘çš„è¿™ä¸ªç‰¹ç‚¹ï¼Œä½¿å¾—df[df.loc[â€˜col_nameâ€™] == â€˜conditionâ€™, â€˜col_nameâ€™] = value_1æˆç«‹ã€‚
å…·ä½“çš„å®é™…åº”ç”¨ï¼Œå¯å‚è€ƒ ä»£ç æ¡ˆä¾‹ ä¸€æ­¥å®ç°EXCELçš„åˆå¹¶æ•°æ®ã€æ•°æ®ç­›é€‰ã€æ•°æ®é€è§†åŠŸèƒ½ã€‚</p>
  </li>
  <li>
    <p><strong>iloc</strong>åˆ©ç”¨indexçš„å…·ä½“ä½ç½®ï¼ˆæ‰€ä»¥å®ƒ<strong>åªèƒ½æ˜¯æ•´æ•°å‹å‚æ•°</strong>ï¼Œ<strong>è¡Œå·</strong>ï¼‰ï¼Œæ¥è·å–æƒ³è¦çš„<strong>è¡Œ</strong>ï¼ˆæˆ–<strong>åˆ—</strong>ï¼‰ã€‚</p>
  </li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># è¿™é‡Œlocå°±å¯ä»¥ç›´æ¥ç”¨è‡ªå·±å†™çš„ç´¢å¼•æ¥æ„æˆ
</span><span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="s">'C'</span><span class="p">:</span><span class="s">'6'</span><span class="p">,</span> <span class="s">'3'</span><span class="p">:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> 

<span class="c1"># åˆ©ç”¨ilocæŠ½å–æŒ‡å®šä½ç½®ï¼ˆæ‰€åœ¨çš„è¡Œæ•´æ•°å€¼ï¼‰çš„ç´¢å¼•æ‰€æ„æˆçš„æ–°çš„dataframe
</span><span class="n">new_dataframe</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index_list</span><span class="p">,:]</span>
</code></pre></div></div>

<p>####1.6 æ‰¾åˆ°Nanå€¼â€”â€”np.isnan()</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nan_np_list</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">np_data</span><span class="p">))</span>
</code></pre></div></div>

<p>####1.7 å“‘å˜é‡ç”Ÿæˆâ€”â€”pd.get_dummies()</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dummy_device_type</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">data_org</span><span class="p">[</span><span class="s">'platform'</span><span class="p">],</span><span class="n">prefix</span><span class="o">=</span><span class="s">'device_type'</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="18-è®¡ç®—ç‰¹å¾ä¹‹é—´çš„ç›¸å…³ç³»æ•°">1.8 è®¡ç®—ç‰¹å¾ä¹‹é—´çš„ç›¸å…³ç³»æ•°</h4>

<p>è‡ªå˜é‡ä¹‹é—´ç›¸å…³ç³»æ•°è¾ƒå¤§çš„è¯ï¼Œéœ€è¦è€ƒè™‘å…±çº¿æ€§çš„é—®é¢˜ï¼Œå…±çº¿æ€§ä¼šå¯¼è‡´æ¨¡å‹å‡ºç°å¼€å¼è§£ï¼Œé™ä½æ¨¡å‹çš„ç¨³å®šæ€§ã€‚</p>

<p>å¸¸è§æ–¹æ³•æœ‰<strong>çš®å°”æ£®ç›¸å…³ç³»æ•°</strong>å’Œ<strong>æ–¯çš®å°”æ›¼ç›¸å…³ç³»æ•°</strong>ã€‚ä¸¤ä¸ªç³»æ•°éƒ½æ˜¯ä»‹äº-1å’Œ1ä¹‹é—´ï¼Œ-1è¡¨ç¤ºå®Œå…¨è´Ÿç›¸å…³ï¼Œ1è¡¨ç¤ºå®Œå…¨æ­£ç›¸å…³ï¼Œ0è¡¨ç¤ºå®Œå…¨ä¸ç›¸å…³ã€‚</p>

<p>ä½¿ç”¨çš®å°”æ£®ç›¸å…³ç³»æ•°æœ‰å±€é™ï¼šè¦æ±‚æ•°æ®æ˜¯æˆå¯¹çš„ä»æ­£æ€åˆ†å¸ƒä¸­å–å¾—çš„ã€‚è€Œæ–¯çš®å°”æ›¼ç›¸å…³ç³»æ•°æ˜¯ä¸€ç§ç§©ç›¸å…³ç³»æ•°ï¼Œä¸å—æ•°æ®åˆ†å¸ƒçš„å½±å“ï¼Œå®ƒé€šè¿‡å¯¹å˜é‡æ’åºï¼Œä»¥æ’åºåä¸¤ä¸ªå˜é‡çš„ç§©æ¬¡å·®æ¥è®¡ç®—ç›¸å…³ç³»æ•°ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pearson</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">corr</span><span class="p">()</span> <span class="c1"># é€‚ç”¨äºéƒ½æ˜¯è¿ç»­æ€§å˜é‡
</span><span class="n">spearman</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">corr</span><span class="p">(</span><span class="s">'spearman'</span><span class="p">)</span> <span class="c1"># é€‚ç”¨äºç¦»æ•£å’Œè¿ç»­å˜é‡
</span></code></pre></div></div>

<h4 id="19-dataframeçš„æ‹¼æ¥">1.9 dataframeçš„æ‹¼æ¥</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_all_row</span> <span class="o">=</span> <span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span><span class="n">df2</span><span class="p">])</span>  <span class="c1">#ç­‰ä»·äº df1.append(df2)ï¼Œçºµç€æ‹¼æ¥
</span>
<span class="c1">#ç­‰ä»·äº merge(df1,df2,left_index=True,right_index=True,how='outer')
</span><span class="n">df_all_col</span> <span class="o">=</span> <span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span><span class="n">df2</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># æ¨ªç€æ‹¼æ¥
</span></code></pre></div></div>

<h4 id="110--groupbyçš„ä½¿ç”¨">1.10  groupbyçš„ä½¿ç”¨</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">'A'</span><span class="p">:</span> <span class="p">[</span><span class="s">'a'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">,</span> <span class="s">'a'</span><span class="p">,</span> <span class="s">'c'</span><span class="p">,</span> <span class="s">'a'</span><span class="p">,</span> <span class="s">'c'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">,</span> <span class="s">'c'</span><span class="p">],</span> 
                   <span class="s">'B'</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> 
                   <span class="s">'C'</span><span class="p">:</span> <span class="p">[</span><span class="mi">102</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">87</span><span class="p">,</span> <span class="mi">92</span><span class="p">,</span> <span class="mi">123</span><span class="p">]})</span>
<span class="n">df</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'A'</span><span class="p">).</span><span class="n">mean</span><span class="p">()</span>
<span class="o">==&gt;</span>     
<span class="n">A</span>   <span class="n">B</span>       <span class="n">C</span>                 
<span class="n">a</span>  <span class="mf">2.0</span>  <span class="mf">108.000000</span>
<span class="n">b</span>  <span class="mf">6.5</span>   <span class="mf">95.000000</span>
<span class="n">c</span>  <span class="mf">5.0</span>  <span class="mf">104.666667</span>
</code></pre></div></div>

<h4 id="111--seriesapply">1.11  Series.apply</h4>

<p>è¯¥å‡½æ•°ç”¨äºå¯¹è¯¥seriesçš„æ‰€æœ‰å…ƒç´ è¿›è¡Œå¤„ç†ç”Ÿæˆä¸€ä¸ªæ–°çš„seriesã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">new_series</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]).</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="s">"""è¿™é‡Œæ˜¯å‡½æ•°ä¸­å¸¦2ä¸ªå‚æ•°çš„"""</span>
<span class="k">def</span> <span class="nf">subtract_custom_value</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">custom_value</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">-</span> <span class="n">custom_value</span>
<span class="n">new_series_2</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">subtract_custom_value</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,))</span>
</code></pre></div></div>

<h4 id="112--serieså¯ä»¥ç›´æ¥ç”¨äº2ä¸ªåˆ—ç›¸åŠ å‡">1.12  Serieså¯ä»¥ç›´æ¥ç”¨äº2ä¸ªåˆ—ç›¸åŠ å‡</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">([</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span>
<span class="n">diff_series</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span>
</code></pre></div></div>

<h3 id="äºŒç»˜å›¾æŸ¥çœ‹æ•°æ®åˆ†å¸ƒseabornå’Œmatplotlib">äºŒ.ç»˜å›¾æŸ¥çœ‹æ•°æ®åˆ†å¸ƒâ€”â€”seabornå’Œmatplotlib</h3>
<h4 id="21-é¢‘æ•°åˆ†å¸ƒç›´æ–¹å›¾">2.1 é¢‘æ•°åˆ†å¸ƒç›´æ–¹å›¾</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">plot_bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">color</span><span class="p">,</span><span class="n">title</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">):</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">bar</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">width</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="n">color</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="s">'%.2f%%'</span> <span class="o">%</span> 			          <span class="p">((</span><span class="n">yy</span><span class="o">/</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">).</span><span class="nb">sum</span><span class="p">())</span><span class="o">*</span><span class="mi">100</span><span class="p">)),</span> <span class="n">ha</span><span class="o">=</span><span class="s">'center'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Hour'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Trade-Frequence'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">15</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">+</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>

<span class="c1"># the histogram of the data
</span><span class="n">n</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">hist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s">'g'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>


<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Smarts'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Probability'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Histogram of IQ'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="p">.</span><span class="mi">025</span><span class="p">,</span> <span class="s">r'$\mu=100,\ \sigma=15$'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">40</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjei4iy6bdj30hs0dcq3t.jpg" alt="" /></p>

<h4 id="22-æ•£ç‚¹å›¾">2.2 æ•£ç‚¹å›¾</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="23-ç›´çº¿å›¾">2.3 ç›´çº¿å›¾</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="24-åŒå˜é‡åˆ†å¸ƒå›¾">2.4 åŒå˜é‡åˆ†å¸ƒå›¾</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">two_dims_draw_relationship</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">xlabel</span><span class="p">,</span><span class="n">ylabel</span><span class="p">):</span>
    <span class="c1"># åŒå˜é‡åˆ†å¸ƒ x,ylabelæ˜¯å­—ç¬¦ä¸²ï¼Œdfå¿…é¡»æ˜¯åŒç»´åº¦çš„dataframe
</span>    <span class="n">sns</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">color_codes</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s">"kde"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">"y"</span><span class="p">)</span>
    <span class="n">g</span><span class="p">.</span><span class="n">plot_joint</span><span class="p">(</span><span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">"m"</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s">"+"</span><span class="p">)</span>
    <span class="n">g</span><span class="p">.</span><span class="n">ax_joint</span><span class="p">.</span><span class="n">collections</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">set_alpha</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># ç”»èƒŒæ™¯ç½‘æ ¼çº¿
</span>    <span class="n">g</span><span class="p">.</span><span class="n">set_axis_labels</span><span class="p">(</span><span class="s">"${}$"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">xlabel</span><span class="p">),</span> <span class="s">"${}$"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">ylabel</span><span class="p">))</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjei4tn70wj30go0goaav.jpg" alt="" /></p>

<h4 id="25-å¤šå˜é‡ä¸¤ä¸¤ä¹‹é—´çš„åˆ†å¸ƒå›¾">2.5 å¤šå˜é‡ä¸¤ä¸¤ä¹‹é—´çš„åˆ†å¸ƒå›¾</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">all_two_feature_distribution</span><span class="p">(</span><span class="n">df</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s">'iris'</span><span class="p">)):</span>
    <span class="n">sns</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s">"ticks"</span><span class="p">)</span>
    <span class="n">sns</span><span class="p">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">"species"</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjei41be5cj30v40qutd8.jpg" alt="" /></p>

<h4 id="26-çƒ­åº¦å›¾">2.6 çƒ­åº¦å›¾</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scores_h</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">scores_h</span><span class="p">).</span><span class="n">reshape</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">scores_h</span><span class="p">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">]</span>
<span class="n">scores_h</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">scores_h</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">xticklabels</span><span class="o">=</span><span class="n">cols_all_features</span><span class="p">,</span>
                 <span class="n">yticklabels</span><span class="o">=</span><span class="n">cols_all_features</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s">'.2f'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"N_cluster"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"linkages"</span><span class="p">)</span>
<span class="c1"># å¿…é¡»å…ˆsavefigï¼Œä¹‹åå†showï¼Œå°±ä¸ä¼šå‡ºç°ä¿å­˜æ—¶ç™½è‰²å›¾ç‰‡äº†
</span><span class="n">plt</span><span class="p">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">"h.jpg"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<h3 id="ä¸‰æœºå™¨å­¦ä¹ åŒ…sklearn">ä¸‰.æœºå™¨å­¦ä¹ åŒ…sklearn</h3>
<h4 id="31-åˆ’åˆ†æ•°æ®é›†">3.1 åˆ’åˆ†æ•°æ®é›†</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="p">(</span><span class="n">trainX</span><span class="p">,</span><span class="n">testX</span><span class="p">,</span><span class="n">trainY</span><span class="p">,</span><span class="n">testY</span><span class="p">)</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="32-ç‰¹å¾æ ‡å‡†åŒ–">3.2 ç‰¹å¾æ ‡å‡†åŒ–</h4>
<h5 id="321-ç¬¬ä¸€ç§">3.2.1 ç¬¬ä¸€ç§</h5>
<p>ä½¿ç”¨scaleæ¨¡å—ç›´æ¥è®¡ç®—æ ‡å‡†åŒ–ï¼Œå°†æ ‡å‡†åŒ–çš„arrayæ”¾åœ¨x_scaleä¸­ï¼ŒåŒæ—¶å¯ä»¥æŸ¥çœ‹å‡å€¼å’Œæ ‡å‡†å·®ï¼Œä½†æ˜¯è¯¥æ–¹å¼çš„ä¸€ä¸ªä¸è¶³æ˜¯å½“å­˜åœ¨æ–°çš„æ ·æœ¬åˆ°æ¥æ—¶ï¼Œæ— æ³•åˆ©ç”¨å·²æœ‰çš„æ¨¡å—ç›´æ¥å¤ç”¨ï¼Œéœ€è¦åˆ©ç”¨meanå’Œstdè‡ªå·±è®¡ç®—ã€‚</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x_scale</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="p">.</span><span class="n">scale</span><span class="p">(</span><span class="n">DatMat</span><span class="p">)</span>  
<span class="n">x_scale</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">x_scale</span><span class="p">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div>
<h5 id="322-ç¬¬äºŒç§">3.2.2 ç¬¬äºŒç§</h5>
<p>ç¬¬äºŒç§ï¼šä½¿ç”¨StandardScaleræ¨¡å—è®¡ç®—æ ‡å‡†åŒ–ï¼Œå¯ä»¥åˆ©ç”¨è®­ç»ƒé›†æ•°æ®å»ºç«‹ä¸€ä¸ªè½¬åŒ–çš„ç±»ï¼Œç±»ä¼¼äºå®ç°å°†meanå’Œstdå­˜å‚¨åœ¨è¯¥ç±»ä¸­ï¼Œå°†æ•°æ®è¾“å…¥ï¼Œå°±å¯ä»¥ç›´æ¥æ±‚å‡ºç»“æœã€‚</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scaler</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="p">.</span><span class="n">StandardScaler</span><span class="p">().</span><span class="n">fit</span><span class="p">(</span><span class="n">datingDatMat</span><span class="p">)</span>
<span class="n">datingDatMat</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">datingDatMat</span><span class="p">)</span>
<span class="n">new_date</span> <span class="o">=</span> <span class="n">numpy</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">new_date_std</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">new_date</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
</code></pre></div></div>
<p>è¿™é‡Œçš„scaleræ›´è±¡æ˜¯æ‰®æ¼”ä¸€ä¸ªè®¡ç®—å™¨çš„è§’è‰²ï¼Œæœ¬èº«å¹¶ä¸å­˜å‚¨æ•°æ®ã€‚</p>

<h4 id="33-äº¤å‰éªŒè¯æŸ¥éªŒæ¨¡å‹ç¨³å®šæ€§">3.3 äº¤å‰éªŒè¯â€”â€”æŸ¥éªŒæ¨¡å‹ç¨³å®šæ€§</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
 <span class="n">model_stability</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">model</span><span class="p">,</span>
                              <span class="n">trainX</span><span class="p">,</span><span class="n">trainY</span><span class="p">,</span><span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">scoring</span><span class="o">=</span><span class="s">"accuracy"</span><span class="p">)</span>
<span class="n">mean_score_model</span> <span class="o">=</span> <span class="n">model_stability</span><span class="p">.</span><span class="n">mean</span><span class="p">()</span>
</code></pre></div></div>

<h4 id="34-æ¨¡å‹è¯„ä¼°æ–¹å¼æ··æ·†çŸ©é˜µ">3.4 æ¨¡å‹è¯„ä¼°æ–¹å¼â€”â€”æ··æ·†çŸ©é˜µ</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="k">print</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">testY</span><span class="p">,</span><span class="n">y_pred</span><span class="p">))</span>
</code></pre></div></div>

<h4 id="35-åˆ†ç±»ç»“æœå±•ç¤ºå‡†ç¡®æ€§å¬å›ç‡f1-score">3.5 åˆ†ç±»ç»“æœå±•ç¤ºï¼ˆå‡†ç¡®æ€§ï¼Œå¬å›ç‡ï¼Œf1-scoreï¼‰</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span>
<span class="k">print</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">testY</span><span class="p">,</span><span class="n">y_pred</span><span class="p">))</span>
</code></pre></div></div>

<h4 id="36-æ¨¡å‹çš„ä¿å­˜å’ŒåŠ è½½">3.6 æ¨¡å‹çš„ä¿å­˜å’ŒåŠ è½½</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pickle</span>
<span class="c1"># ä¿å­˜æ¨¡å‹
</span><span class="n">pickle</span><span class="p">.</span><span class="n">dump</span><span class="p">(</span><span class="n">rf_clf</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="s">'model/model.model'</span><span class="p">,</span> <span class="s">'wb'</span><span class="p">))</span>
<span class="c1"># å¯¼å…¥æ¨¡å‹
</span><span class="n">model</span> <span class="o">=</span> <span class="n">pickle</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s">'model_save/model.model'</span><span class="p">,</span><span class="s">'wb'</span><span class="p">))</span>
</code></pre></div></div>

<h4 id="37-æ•°æ®æ ·æœ¬ä¸å‡è¡¡smoteenn">3.7 æ•°æ®æ ·æœ¬ä¸å‡è¡¡â€”â€”SMOTEENN</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">imblearn.combine</span> <span class="kn">import</span> <span class="n">SMOTEENN</span>
<span class="n">smote_enn</span> <span class="o">=</span> <span class="n">SMOTEENN</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">X_resampled</span><span class="p">,</span><span class="n">y_resampled</span> <span class="o">=</span> <span class="n">smote_enn</span><span class="p">.</span><span class="n">fit_sample</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="38-è‡ªåŠ¨è¶…å‚è°ƒèŠ‚">3.8 è‡ªåŠ¨è¶…å‚è°ƒèŠ‚</h4>
<h5 id="381-è‡ªåŠ¨è°ƒå‚gridsearchcv">3.8.1 è‡ªåŠ¨è°ƒå‚â€”â€”GridSearchCV</h5>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
<span class="n">rcl</span><span class="o">=</span><span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">min_samples_split</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">min_samples_leaf</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">max_features</span><span class="o">=</span><span class="s">'sqrt'</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="c1"># ç°åœ¨ä¸ç¡®å®šRandomForestå…¶ä¸­ä¸€ä¸ªå‚æ•°n_estimatorsçš„ä¸ªæ•°
</span><span class="n">param_test1</span> <span class="o">=</span> <span class="p">{</span><span class="s">'n_estimators'</span><span class="p">:</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">71</span><span class="p">,</span><span class="mi">10</span><span class="p">)}</span>
<span class="n">gsearch1</span><span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span> <span class="o">=</span><span class="n">rcl</span><span class="p">,</span><span class="n">param_grid</span><span class="o">=</span>                                              <span class="n">param_test1</span><span class="p">,</span><span class="n">scoring</span><span class="o">=</span><span class="s">'roc_auc'</span><span class="p">,</span><span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">gsearch1</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">gsearch1</span><span class="p">.</span><span class="n">grid_scores_</span><span class="p">,</span> <span class="n">gsearch1</span><span class="p">.</span><span class="n">best_params_</span><span class="p">,</span> 	           <span class="n">gsearch1</span><span class="p">.</span><span class="n">best_score_</span><span class="p">)</span>
</code></pre></div></div>

<h5 id="382-è‡ªåŠ¨è°ƒå‚ç¥å™¨hyperopt">3.8.2 è‡ªåŠ¨è°ƒå‚ç¥å™¨â€”â€”Hyperopt</h5>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">hyperopt</span> <span class="kn">import</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">tpe</span><span class="p">,</span> <span class="n">hp</span><span class="p">,</span> <span class="n">rand</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">svm</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>

<span class="c1"># SVMçš„ä¸‰ä¸ªè¶…å‚æ•°ï¼šCä¸ºæƒ©ç½šå› å­ï¼Œkernelä¸ºæ ¸å‡½æ•°ç±»å‹ï¼Œgammaä¸ºæ ¸å‡½æ•°çš„é¢å¤–å‚æ•°ï¼ˆå¯¹äºä¸åŒç±»å‹çš„æ ¸å‡½æ•°æœ‰ä¸åŒçš„å«ä¹‰ï¼‰
# æœ‰åˆ«äºä¼ ç»Ÿçš„ç½‘æ ¼æœç´¢ï¼ˆGridSearchï¼‰ï¼Œè¿™é‡Œåªéœ€è¦ç»™å‡ºæœ€ä¼˜å‚æ•°çš„æ¦‚ç‡åˆ†å¸ƒå³å¯ï¼Œè€Œä¸éœ€è¦æŒ‰ç…§æ­¥é•¿æŠŠå…·ä½“çš„å€¼ç»™ä¸€ä¸ªä¸ªæšä¸¾å‡ºæ¥
</span><span class="n">parameter_space_svc</span> <span class="o">=</span><span class="p">{</span>
    <span class="c1"># loguniformè¡¨ç¤ºè¯¥å‚æ•°å–å¯¹æ•°åç¬¦åˆå‡åŒ€åˆ†å¸ƒ
</span>    <span class="s">'C'</span><span class="p">:</span><span class="n">hp</span><span class="p">.</span><span class="n">loguniform</span><span class="p">(</span><span class="s">"C"</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="mi">100</span><span class="p">)),</span>
    <span class="s">'kernel'</span><span class="p">:</span><span class="n">hp</span><span class="p">.</span><span class="n">choice</span><span class="p">(</span><span class="s">'kernel'</span><span class="p">,[</span><span class="s">'rbf'</span><span class="p">,</span><span class="s">'poly'</span><span class="p">]),</span>
    <span class="s">'gamma'</span><span class="p">:</span> <span class="n">hp</span><span class="p">.</span><span class="n">loguniform</span><span class="p">(</span><span class="s">"gamma"</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.001</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)),</span>
<span class="p">}</span>

<span class="c1"># é¸¢å°¾èŠ±å‰æ•°æ®é›†ï¼Œæ˜¯ä¸€ç±»å¤šé‡å˜é‡åˆ†æçš„æ•°æ®é›†
# é€šè¿‡èŠ±è¼é•¿åº¦ï¼ŒèŠ±è¼å®½åº¦ï¼ŒèŠ±ç“£é•¿åº¦ï¼ŒèŠ±ç“£å®½åº¦4ä¸ªå±æ€§é¢„æµ‹é¸¢å°¾èŠ±å‰å±äºï¼ˆSetosaï¼ŒVersicolourï¼ŒVirginicaï¼‰ä¸‰ä¸ªç§ç±»ä¸­çš„å“ªä¸€ç±»
</span><span class="n">iris</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">.</span><span class="n">load_digits</span><span class="p">()</span>

<span class="c1">#--------------------åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†--------------------
</span><span class="n">train_data</span> <span class="o">=</span> <span class="n">iris</span><span class="p">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1300</span><span class="p">]</span>
<span class="n">train_target</span> <span class="o">=</span> <span class="n">iris</span><span class="p">.</span><span class="n">target</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1300</span><span class="p">]</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="n">iris</span><span class="p">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1300</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">test_target</span> <span class="o">=</span> <span class="n">iris</span><span class="p">.</span><span class="n">target</span><span class="p">[</span><span class="mi">1300</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="c1">#-----------------------------------------------------------
</span>
<span class="c1"># è®¡æ•°å™¨ï¼Œæ¯ä¸€æ¬¡å‚æ•°ç»„åˆçš„æšä¸¾éƒ½ä¼šä½¿å®ƒåŠ 1
</span><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">function</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s">"C"</span><span class="p">]</span>
    <span class="n">kernel</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s">"kernel"</span><span class="p">]</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s">"gamma"</span><span class="p">]</span>

    <span class="c1"># **å¯ä»¥æŠŠdictè½¬æ¢ä¸ºå…³é”®å­—å‚æ•°ï¼Œå¯ä»¥å¤§å¤§ç®€åŒ–å¤æ‚çš„å‡½æ•°è°ƒç”¨
</span>    <span class="n">clf</span> <span class="o">=</span> <span class="n">svm</span><span class="p">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="n">c</span><span class="p">,</span><span class="n">kernel</span> <span class="o">=</span> <span class="n">kernel</span><span class="p">,</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">gamma</span><span class="p">)</span>

    <span class="c1"># è®­ç»ƒæ¨¡å‹
</span>    <span class="n">clf</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span><span class="n">train_target</span><span class="p">)</span>

    <span class="c1"># é¢„æµ‹æµ‹è¯•é›†
</span>    <span class="n">prediction</span> <span class="o">=</span> <span class="n">clf</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

    <span class="k">global</span> <span class="n">count</span>
    <span class="n">count</span> <span class="o">=</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">score</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">test_target</span><span class="p">,</span><span class="n">prediction</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"ç¬¬%sæ¬¡ï¼Œæµ‹è¯•é›†æ­£ç¡®ç‡ä¸ºï¼š"</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">count</span><span class="p">),</span><span class="n">score</span><span class="p">)</span>

    <span class="c1"># ç”±äºhyperoptä»…æä¾›fminæ¥å£ï¼Œå› æ­¤å¦‚æœè¦æ±‚æœ€å¤§å€¼ï¼Œåˆ™éœ€è¦å–ç›¸åæ•°
</span>    <span class="k">return</span> <span class="o">-</span><span class="n">score</span>

<span class="c1"># algoæŒ‡å®šæœç´¢ç®—æ³•ï¼Œç›®å‰æ”¯æŒä»¥ä¸‹ç®—æ³•ï¼š
# â‘ éšæœºæœç´¢(hyperopt.rand.suggest)
# â‘¡æ¨¡æ‹Ÿé€€ç«(hyperopt.anneal.suggest)
# â‘¢TPEç®—æ³•ï¼ˆhyperopt.tpe.suggestï¼Œç®—æ³•å…¨ç§°ä¸ºTree-structured Parzen Estimator Approachï¼‰
# max_evalsæŒ‡å®šæšä¸¾æ¬¡æ•°ä¸Šé™ï¼Œå³ä½¿ç¬¬max_evalsæ¬¡æšä¸¾ä»æœªèƒ½ç¡®å®šå…¨å±€æœ€ä¼˜è§£ï¼Œä¹Ÿè¦ç»“æŸæœç´¢ï¼Œè¿”å›ç›®å‰æœç´¢åˆ°çš„æœ€ä¼˜è§£
</span><span class="n">best</span> <span class="o">=</span> <span class="n">fmin</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="n">parameter_space_svc</span><span class="p">,</span> <span class="n">algo</span><span class="o">=</span><span class="n">tpe</span><span class="p">.</span><span class="n">suggest</span><span class="p">,</span> <span class="n">max_evals</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># best["kernel"]è¿”å›çš„æ˜¯æ•°ç»„ä¸‹æ ‡ï¼Œå› æ­¤éœ€è¦æŠŠå®ƒè¿˜åŸå›æ¥
</span><span class="n">kernel_list</span> <span class="o">=</span> <span class="p">[</span><span class="s">'rbf'</span><span class="p">,</span><span class="s">'poly'</span><span class="p">]</span>
<span class="n">best</span><span class="p">[</span><span class="s">"kernel"</span><span class="p">]</span> <span class="o">=</span> <span class="n">kernel_list</span><span class="p">[</span><span class="n">best</span><span class="p">[</span><span class="s">"kernel"</span><span class="p">]]</span>

<span class="k">print</span><span class="p">(</span><span class="s">"æœ€ä½³å‚æ•°ä¸ºï¼š"</span><span class="p">,</span><span class="n">best</span><span class="p">)</span>

<span class="n">clf</span> <span class="o">=</span> <span class="n">svm</span><span class="p">.</span><span class="n">SVC</span><span class="p">(</span><span class="o">**</span><span class="n">best</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">clf</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="39-to_categorical">3.9 to_categorical</h4>
<p>åŠŸèƒ½ï¼šå°†labelè½¬ä¸ºone_hotå½¢å¼ï¼Œæºäºkeras.utilsåŒ…</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">keras.utils</span> <span class="kn">import</span> <span class="n">to_categorical</span>
<span class="n">y_onehot</span> <span class="o">=</span> <span class="n">to_categorical</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">num_classes</span><span class="p">(</span><span class="n">æ€»ç±»åˆ«æ•°</span><span class="p">))</span>
</code></pre></div></div>

<h4 id="310-ç»˜åˆ¶rocæ›²çº¿">3.10 ç»˜åˆ¶ROCæ›²çº¿</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_curve</span><span class="p">,</span> <span class="n">auc</span>
<span class="k">def</span> <span class="nf">draw_ROC_curve</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_predict</span><span class="p">,</span> <span class="n">savepath</span><span class="p">):</span>
    <span class="s">'''ç”»ROCæ›²çº¿'''</span>
    <span class="n">false_positive_rate</span><span class="p">,</span> <span class="n">true_positive_rate</span><span class="p">,</span> <span class="n">thresholds</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_predict</span><span class="p">)</span>
    <span class="n">roc_auc</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">false_positive_rate</span><span class="p">,</span> <span class="n">true_positive_rate</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'ROC'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">false_positive_rate</span><span class="p">,</span> <span class="n">true_positive_rate</span><span class="p">,</span> <span class="s">'b'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'AUC = %0.2f'</span> <span class="o">%</span> <span class="n">roc_auc</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">'lower right'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s">'r--'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'TPR'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'FPR'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savepath</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">close</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="å››åˆ†ç±»æ¨¡å‹">å››.åˆ†ç±»æ¨¡å‹</h3>
<h4 id="41-éšæœºæ£®æ—">4.1 éšæœºæ£®æ—</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="n">rf_clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">700</span>
<span class="p">,</span><span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">max_leaf_nodes</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">rf_clf</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">trainX</span><span class="p">,</span><span class="n">trainY</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">rf_clf</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">testX</span><span class="p">)</span>
<span class="c1"># ç‰¹å¾é‡è¦æ€§
</span><span class="n">feature_importance</span> <span class="o">=</span> <span class="n">rf_clf</span><span class="p">.</span><span class="n">feature_importances_</span>
</code></pre></div></div>

<h4 id="42xgboost">4.2.Xgboost</h4>
<p>ä¼˜åŠ¿ï¼šè¡¨ç°å¿«ï¼Œè®­ç»ƒæ—¶å¯ä»¥ç”¨æ‰€æœ‰çš„ CPU å†…æ ¸æ¥å¹¶è¡ŒåŒ–å»ºæ ‘ï¼›ç”¨åˆ†å¸ƒå¼è®¡ç®—æ¥è®­ç»ƒéå¸¸å¤§çš„æ¨¡å‹ï¼›å¯¹äºéå¸¸å¤§çš„æ•°æ®é›†è¿˜å¯ä»¥è¿›è¡Œ Out-of-Core Computing)ã€‚å‚æ•°ï¼šlearning_rate ï¼ 0.1 æˆ–æ›´å°ï¼Œè¶Šå°å°±éœ€è¦å¤šåŠ å…¥å¼±å­¦ä¹ å™¨ï¼›tree_depth ï¼ 2ï½8ï¼›subsample ï¼ è®­ç»ƒé›†çš„ 30%ï½80%ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBClassifier</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">XGBClassifier</span><span class="p">()</span>
<span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="c1"># å¯ä»¥åœ¨æ¯åŠ å…¥ä¸€é¢—æ ‘åæ‰“å°å‡º logloss
</span><span class="n">eval_set</span> <span class="o">=</span> <span class="p">[(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)]</span>
<span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">early_stopping_rounds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">eval_metric</span><span class="o">=</span><span class="s">"logloss"</span><span class="p">,</span> <span class="n">eval_set</span><span class="o">=</span><span class="n">eval_set</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c1"># è¾“å‡ºç‰¹å¾é‡è¦æ€§
</span><span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">plot_importance</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="n">plot_importance</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">pyplot</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<h4 id="43-svm">4.3 SVM</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">gamma</span><span class="o">=</span><span class="s">'auto'</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">kernel</span> <span class="o">=</span> <span class="s">"RBF"</span><span class="p">)</span>
<span class="n">clf</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">testX</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="äº”èšç±»æ¨¡å‹">äº”.èšç±»æ¨¡å‹</h3>
<h4 id="51è½®å»“ç³»æ•°">5.1.è½®å»“ç³»æ•°</h4>
<p>è¯„ä¼°èšç±»æ•ˆæœå¥½åâ€”â€”è½®å»“ç³»æ•°ï¼ˆSilhouette Coefficientï¼‰ç»“åˆäº†èšç±»çš„å‡èšåº¦ï¼ˆCohesionï¼‰å’Œåˆ†ç¦»åº¦ï¼ˆSeparationï¼‰ï¼Œç”¨äºè¯„ä¼°èšç±»çš„æ•ˆæœã€‚è¯¥å€¼å¤„äº-1~1ä¹‹é—´ï¼Œå€¼è¶Šå¤§ï¼Œè¡¨ç¤ºèšç±»æ•ˆæœè¶Šå¥½ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#èšç±»è¯„ä¼°ï¼šè½®å»“ç³»æ•°
</span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">silhouette_score</span>
<span class="c1"># Kmeansçš„èšç±»ç»“æœæ¥è¿›è¡Œæµ‹è¯•
</span><span class="n">labels</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">k</span><span class="p">).</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">).</span><span class="n">labels_</span>
<span class="n">score</span> <span class="o">=</span> <span class="n">silhouette_score</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
</code></pre></div></div>

:ET